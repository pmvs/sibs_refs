DROP TABLE IF EXISTS `plcp`.`bp_adfs_tokens`;
CREATE TABLE  `plcp`.`bp_adfs_tokens` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `dt_pedido` date NOT NULL,
  `audience` varchar(100) NOT NULL,
  `resource` varchar(100) NOT NULL,
  `client_id` varchar(55) NOT NULL,
  `client_assertion` varchar(1024) NOT NULL,
  `access_token` varchar(2048) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `token_type` varchar(45) NOT NULL,
  `expires_in` int unsigned NOT NULL,
  `ativo` tinyint(1) NOT NULL,
  `valid_until` datetime NOT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `Index_2` (`dt_pedido`,`ativo`)
) ENGINE=InnoDB AUTO_INCREMENT=112 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

DROP TABLE IF EXISTS `plcp`.`bp_cop_payload`;
CREATE TABLE  `plcp`.`bp_cop_payload` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `dt_pedido` date NOT NULL,
  `request_id` int unsigned NOT NULL,
  `n_netcaixa` varchar(45) NOT NULL,
  `user_id` int unsigned NOT NULL,
  `psp_code` varchar(4) NOT NULL,
  `psp_code_destination` varchar(4) NOT NULL,
  `iban` varchar(25) NOT NULL,
  `account_holder` varchar(255) DEFAULT NULL,
  `commercial_name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  `correlation_id_origin` varchar(55) DEFAULT NULL,
  `timestamp` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `success` tinyint(1) NOT NULL,
  `correlation_id` varchar(55) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `message` varchar(255) NOT NULL,
  `errors_codes` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  `errors_values` varchar(1024) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `http_code` smallint unsigned NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=173 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
DROP TABLE IF EXISTS `plcp`.`bp_pl_assoc`;
CREATE TABLE  `plcp`.`bp_pl_assoc` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `dt_pedido` date NOT NULL,
  `request_id` int unsigned NOT NULL,
  `correlation_id` varchar(55) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `status` smallint unsigned NOT NULL,
  `n_netcaixa` varchar(45) NOT NULL,
  `user_id` int unsigned NOT NULL,
  `psp_code` varchar(4) NOT NULL,
  `customer_identifier` varchar(19) NOT NULL,
  `customer_identifier_type` smallint unsigned NOT NULL,
  `fiscal_number` varchar(11) NOT NULL,
  `customer_type` smallint unsigned NOT NULL,
  `iban` varchar(25) NOT NULL,
  `correlation_id_origin` varchar(55) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `timestamp` varchar(25) NOT NULL,
  `http_code` smallint unsigned NOT NULL,
  PRIMARY KEY (`id`),
  KEY `Index_2` (`n_netcaixa`,`customer_identifier`,`fiscal_number`,`iban`,`status`)
) ENGINE=InnoDB AUTO_INCREMENT=77 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

DROP TABLE IF EXISTS `plcp`.`bp_pl_payload`;
CREATE TABLE  `plcp`.`bp_pl_payload` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `dt_pedido` date NOT NULL,
  `request_id` int unsigned NOT NULL,
  `n_netcaixa` varchar(45) NOT NULL,
  `user_id` int unsigned NOT NULL,
  `psp_code` varchar(4) NOT NULL,
  `customer_identifier` varchar(19) NOT NULL,
  `customer_identifier_type` smallint unsigned NOT NULL,
  `fiscal_number` varchar(11) NOT NULL,
  `customer_type` smallint unsigned NOT NULL,
  `iban` varchar(25) NOT NULL,
  `correlation_id_origin` varchar(55) DEFAULT NULL,
  `timestamp` varchar(25) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `success` tinyint(1) NOT NULL,
  `correlation_id` varchar(55) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `message` varchar(255) NOT NULL,
  `errors_codes` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  `errors_values` varchar(1024) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `http_code` smallint unsigned NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=302 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
DROP TABLE IF EXISTS `plcp`.`bp_pl_requests`;
CREATE TABLE  `plcp`.`bp_pl_requests` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `dt_pedido` date NOT NULL,
  `http_code_response` int unsigned NOT NULL,
  `timeelapsed` float NOT NULL DEFAULT '0',
  `n_netcaixa` varchar(45) NOT NULL,
  `user_id` int NOT NULL,
  `correlation_id` varchar(55) NOT NULL,
  `token_id` int unsigned NOT NULL,
  `audience` varchar(255) NOT NULL,
  `payload` mediumtext NOT NULL,
  `response` mediumtext NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `Index_2` (`correlation_id`)
) ENGINE=InnoDB AUTO_INCREMENT=733 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

DROP TABLE IF EXISTS `plcp`.`cop`;
CREATE TABLE  `plcp`.`cop` (
  `nif` char(11) NOT NULL,
  `nome` char(70) NOT NULL,
  `tp_entidade` char(1) NOT NULL,
  `iban` char(25) NOT NULL,
  `n_titular` smallint unsigned NOT NULL,
  KEY `Index_2` (`iban`,`nif`),
  KEY `Index_3` (`iban`,`n_titular`),
  KEY `Index_4` (`nif`),
  KEY `Index_5` (`nome`),
  KEY `Index_6` (`iban`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

DROP TABLE IF EXISTS `plcp`.`psp_cop_requests`;
CREATE TABLE  `plcp`.`psp_cop_requests` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `dt_pedido` date NOT NULL,
  `http_code_response` int unsigned NOT NULL,
  `timeelapsed` float NOT NULL DEFAULT '0',
  `n_netcaixa` varchar(45) NOT NULL,
  `user_id` int NOT NULL,
  `correlation_id` varchar(55) NOT NULL,
  `token_used` varchar(2048) NOT NULL,
  `audience` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `payload` mediumtext NOT NULL,
  `response` mediumtext NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT NULL,
  `psp_origin_code` char(4) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `Index_2` (`correlation_id`)
) ENGINE=InnoDB AUTO_INCREMENT=350 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

DROP TABLE IF EXISTS `plcp`.`psp_notification_expired`;
CREATE TABLE  `plcp`.`psp_notification_expired` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `dt_pedido` date NOT NULL,
  `request_id` int unsigned NOT NULL,
  `n_netcaixa` varchar(45) NOT NULL,
  `user_id` int unsigned NOT NULL,
  `correlation_id` varchar(55) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `correlation_id_origin` varchar(55) DEFAULT NULL,
  `customer_identifier` varchar(25) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `customer_identifier_type` smallint unsigned NOT NULL,
  `fiscal_number` varchar(11) NOT NULL,
  `customer_type` smallint unsigned NOT NULL,
  `iban` varchar(25) NOT NULL,
  `message` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `status` char(1) NOT NULL,
  `dt_status` timestamp NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=173 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

DROP TABLE IF EXISTS `plcp`.`psp_notification_removed`;
CREATE TABLE  `plcp`.`psp_notification_removed` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `dt_pedido` date NOT NULL,
  `request_id` int unsigned NOT NULL,
  `n_netcaixa` varchar(45) NOT NULL,
  `user_id` int unsigned NOT NULL,
  `correlation_id` varchar(55) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `correlation_id_origin` varchar(55) DEFAULT NULL,
  `customer_identifier` varchar(25) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `customer_identifier_type` smallint unsigned NOT NULL,
  `fiscal_number` varchar(11) NOT NULL,
  `customer_type` smallint unsigned NOT NULL,
  `iban` varchar(25) NOT NULL,
  `message` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `status` char(1) DEFAULT NULL,
  `dt_status` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=166 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


DROP TABLE IF EXISTS `plcp`.`psp_notifications`;
CREATE TABLE  `plcp`.`psp_notifications` (
  `id` int unsigned NOT NULL AUTO_INCREMENT,
  `dt_pedido` date NOT NULL,
  `http_code_response` int unsigned NOT NULL,
  `timeelapsed` float NOT NULL DEFAULT '0',
  `n_netcaixa` varchar(45) NOT NULL,
  `user_id` int NOT NULL,
  `correlation_id` varchar(55) NOT NULL,
  `token_used` varchar(2048) NOT NULL,
  `audience` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `payload` text NOT NULL,
  `response` text NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `Index_2` (`correlation_id`)
) ENGINE=InnoDB AUTO_INCREMENT=247 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


php artisan migrate 


create user 'gba'@'%' identified with mysql_native_password by 'sonos';
grant all privileges on *.* to 'root'@'%';
update mysql.user set host ='%' where user = 'root';
alter user 'root'@'%' identified with mysql_native_password by 'sonos'

// DEPOIS ADICIOANR AS BASE DE DASOS TODAS E DAR GRANT ALL
